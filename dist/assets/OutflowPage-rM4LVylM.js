import{n as i,o as f,p as d,r as a,j as o,m as w,i as m}from"./index-BvvL1rGo.js";import{a as p}from"./Toast-B5XXwoML.js";import{M as O}from"./MasterForm-BRiRbtCm.js";import{H as h}from"./html5-qrcode-scanner-QyajDaF6.js";function g(){const[n,s]=i(),[u,e]=f(),[t,r]=d();return{create:n,update:u,delete:async(...c)=>p(t(...c),{pending:"Удаление расхода...",success:"Расход успешно удален!",error:"Ошибка при удалении расхода"}),createOutflowResult:s,updateOutflowResult:e,deleteOutflowResult:r,isLoading:s.loading||e.loading||r.loading}}const R=({onResult:n,fps:s=10,qrbox:u=250})=>{const e=a.useRef(null),t=a.useRef(null),r=a.useRef(!1);return a.useEffect(()=>{if(!e.current)return;const l=new h(e.current.id);return t.current=l,l.start({facingMode:"environment"},{fps:s,qrbox:u},c=>{n(c)},c=>{}).then(()=>{r.current=!0}).catch(console.error),()=>{t.current&&r.current&&t.current.stop().catch(console.warn).finally(()=>{t.current?.clear().catch(console.warn),r.current=!1})}},[e,s,u,n]),o.jsx("div",{ref:e,id:"html5qr-reader",style:{width:"300px"}})},x=()=>{const{result:n}=w(),{create:s,update:u,isLoading:e}=g(),[t,r]=a.useState("");return m(n)?null:o.jsxs(o.Fragment,{children:[o.jsx(O,{elements:n,crud:{create:s,update:u},error:void 0,refetch:()=>{},isLoading:e}),o.jsx(R,{onResult:r,fps:10,qrbox:250}),o.jsxs("p",{children:["Результат: ",t]})]})},y=()=>o.jsx(x,{});export{y as OutflowPage};
